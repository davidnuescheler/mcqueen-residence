{"version":3,"sources":["fetch-fstab.js"],"names":["rp","require","fetch","context","secrets","request","logger","log","owner","repo","ref","params","rootUrl","REPO_RAW_ROOT","url","info","json","e","module","exports"],"mappings":"AAAA;;;;;;;;;;;;AAYA;AACA,MAAMA,EAAE,GAAGC,OAAO,CAAC,wBAAD,CAAlB;AAEA;;;;;;AAIA,eAAeC,KAAf,CAAqBC,OAArB,EAA8B;AAAEC,EAAAA,OAAO,GAAG,EAAZ;AAAgBC,EAAAA,OAAhB;AAAyBC,EAAAA,MAAM,EAAEC;AAAjC,CAA9B,EAAsE;AACpE,QAAM;AACJC,IAAAA,KADI;AACGC,IAAAA,IADH;AACSC,IAAAA;AADT,MAEFL,OAAO,CAACM,MAFZ;AAGA,QAAMC,OAAO,GAAGR,OAAO,CAACS,aAAR,IAAyB,oCAAzC;AACA,QAAMC,GAAG,GAAI,GAAEF,OAAQ,GAAEJ,KAAM,IAAGC,IAAK,IAAGC,GAAI,aAA9C;AACAH,EAAAA,GAAG,CAACQ,IAAJ,CAAU,kBAAiBD,GAAI,EAA/B;;AACA,MAAI;AACF,WAAO,MAAMd,EAAE,CAAC;AACdc,MAAAA,GADc;AAEdE,MAAAA,IAAI,EAAE;AAFQ,KAAD,CAAf;AAID,GALD,CAKE,OAAOC,CAAP,EAAU;AACVV,IAAAA,GAAG,CAACQ,IAAJ,CAAS,sBAAT,EAAiCE,CAAjC;AACA,WAAO,IAAP;AACD;AACF;;AAEDC,MAAM,CAACC,OAAP,GAAiBjB,KAAjB","file":"fetch-fstab.js","sourceRoot":"../pages/master/src","sourcesContent":["/*\n * Copyright 2019 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\n/* eslint-disable no-param-reassign */\nconst rp = require('request-promise-native');\n\n/**\n * Tries to load the `fstab.json` from the content repository.\n * @return {*} the fstab object or {@code null}\n */\nasync function fetch(context, { secrets = {}, request, logger: log }) {\n  const {\n    owner, repo, ref,\n  } = request.params;\n  const rootUrl = secrets.REPO_RAW_ROOT || 'https://raw.githubusercontent.com/';\n  const url = `${rootUrl}${owner}/${repo}/${ref}/fstab.json`;\n  log.info(`trying to load ${url}`);\n  try {\n    return await rp({\n      url,\n      json: true,\n    });\n  } catch (e) {\n    log.info('unable to load fstab', e);\n    return null;\n  }\n}\n\nmodule.exports = fetch;\n"]}